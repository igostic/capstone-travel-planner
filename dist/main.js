var Client=function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"App",(function(){return L}));const a=async e=>{const t=await fetch(e);try{return await t.json()}catch(e){console.log("Error API Data:",e)}},r=async(e="",t={})=>{const n=await fetch(e,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});try{return await n.json()}catch(e){console.log("Error installing data on the server: ",e)}},i=(e,t,n,a)=>{let r=document.createElement("div");r.classList.add("result-content");let i=`\n        <div class="result-info">\n            <figure class="info-image">\n                <img src="${n.photo}">\n                <figcaption>${n.city}</figcaption>\n            </figure>\n            <div class="country-info country">Country: \n                <span class="data">${n.country}</span>\n                <span class="flag"><img src="${n.flag?n.flag:""}"></span>\n            </div> \n            <div class="country-info">Capital:<span class="data">${n.capital?n.capital:" – "}</span></div>\n            <div class="country-info">Region:<span class="data">${n.region?n.region:" – "}</span></div>\n            <div class="country-info">Subregion:<span class="data">${n.subregion?n.subregion:" – "}</span></div>\n            <div class="country-info">Population:<span class="data">${n.population?n.population:" – "}</span></div>\n            <div class="country-info">languages:<span class="data">${n.languages?n.languages:" – "}</span></div>\n            <div class="country-info">Currencies:<span class="data">${n.currencies?n.currencies:" – "}</span></div>\n            <div class="country-info">Timezones:<span class="data">${n.timezones?n.timezones:" – "}</span></div>\n        </div> \n\n        <div class="result-trip">\n            <div class="trip-to">May trip to: <strong>${n.city}, ${n.country}</strong></div>\n            <div class="departing">Departing: <strong>${n.departing}</strong></div>\n\n            <div class="amount">${n.city}, ${n.country} is <strong>${n.amount}</strong> days away</div>\n\n            <div class="weather-content">\n                <div class="weather-start">\n                    <h2>Weather now (${n.startDay})</h2>\n                    <div class="weather-icon">\n                        <img src="media/${n.currentIcon}.png" />\n                    </div>\n                    <div class="weather-temp">\n                        <div class="weather-low">Low: <strong>${n.currentMin}</strong></div>\n                        <div class="weather-high">High: <strong>${n.currentMax}</strong></div>\n                    </div>\n                    <div class="weather-descr">${n.currentDescr}</div>\n                </div>\n\n                <div class="weather-depart">\n                    <h2>Weather in the future (${n.departing})</h2>\n                    <div class="weather-icon">\n                        <img src="media/${n.futureIcon}.png" />\n                    </div>\n                    <div class="weather-temp">\n                        <div class="weather-low">Low: <strong>${n.futureMin}</strong></div>\n                        <div class="weather-high">High: <strong>${n.futureMax}</strong></div>\n                    </div>\n                    <div class="weather-descr">${n.futureDescr}</div>\n                </div>\n            </div>\n\n            <div class="weather-range">Temperature range from <strong>${n.minTemp}</strong> to <strong>${n.maxTemp}</strong></div>\n\n            <div class="btn-group">\n                <button class="btn save-trip">Save Trip</button>\n                <button class="btn done-trip">${n.done?"Activate":"Done"}</button>\n                <button class="btn remove-trip">Remove Trip</button>\n            </div>\n        </div>\n    `;r.innerHTML=i,r.id=n.id,n.done&&r.classList.add("done"),T(r,n,a,n.id),"result"===a?e.append(r):t.prepend(r)},s=(e,t)=>{let n=[];return e.forEach(e=>n.push(e[t])),n.join(", ")},o=()=>{let e=new Date,t=e.getDate(),n=t>10?t:"0"+t,a=e.getMonth()+1,r=a>10?a:"0"+a;return`${e.getFullYear()}/${r}/${n}`},l=document.getElementById("city"),c=document.getElementById("date"),d=document.getElementById("get"),u=JSON.parse(localStorage.getItem("trips")),p=document.getElementById("result-trip"),g=document.getElementById("list-trip"),y=document.querySelector(".error"),v=document.querySelector(".modal"),m=document.querySelector(".modal-curtain"),f=document.querySelector(".btn-delete"),h=document.querySelector(".btn-cancel"),w=document.querySelector(".question-delete"),b=document.querySelector(".loader");let $=[],S=!1,x="";let E="http://localhost:3030"===window.location.href?"http://localhost:3030/":"http://localhost:3030";const L=()=>{d.addEventListener("click",async()=>{if(p.innerHTML="",y.style.display="none",w.style.display="none",b.style.display="flex",v.classList.add("active"),S=!0,""===l.value||""===c.value)return y.style.display="block",y.innerText="Enter the city and date in the input fields!",k(),!1;{let e=Date.now(),t=((e,t)=>{let n=new Date(t).getTime();if(n>e){let t=n-e;return(Math.round(t/1e3/60/60*100)/100/24).toFixed(0)}return!1})(e,c.value),n=t<15?t:15;if(!t)return y.style.display="block",y.innerText="Enter a date in the future!",c.value="",k(),!1;let r=await a(E+"/apidata"),{geoLogin:d,weatherKey:u,pixabayKey:v}=r,m="&username="+d,f="http://api.geonames.org/searchJSON?q="+l.value+m,h=await a("https://cors-anywhere.herokuapp.com/"+f);h.geonames[0]||I();let{lat:w,lng:$,name:S,countryName:x}=h.geonames[0],L=`https://api.weatherbit.io/v2.0/forecast/daily?lat=${w}&lon=${$}&key=${u}`,T=await a(L);T||I();let M=(e=>{let t=[],n=[];return e.forEach(e=>{t.push(e.min_temp),n.push(e.max_temp)}),{min:Math.min.apply(null,t),max:Math.max.apply(null,n)}})(T.data),O=`https://pixabay.com/api/?key=${v}&q=${S}+${x}&image_type=photo`,q=await a(O);q||I();let D="https://restcountries.eu/rest/v2/name/"+x,_=await a(D);_[0]||I();let{capital:j,region:N,subregion:J,timezones:P,population:B,currencies:C,languages:H,flag:z}=_[0];b.style.display="none";let A={id:"trip_"+e,city:S,country:x,flag:z,capital:j,region:N,subregion:J,timezones:P.join(", "),population:B,currencies:s(C,"code"),languages:s(H,"name"),startDay:o(),departing:c.value.replace(/-/g,"/"),amount:t,photo:q.hits[0].webformatURL,minTemp:M.min,maxTemp:M.max,currentMin:T.data[0].min_temp,currentMax:T.data[0].max_temp,currentIcon:T.data[0].weather.icon,currentDescr:T.data[0].weather.description,futureMin:T.data[n].min_temp,futureMax:T.data[n].max_temp,futureIcon:T.data[n].weather.icon,futureDescr:T.data[n].weather.description,done:!1};i(p,g,A,"result"),l.value="",c.value=""}})},T=async(e,t,n,a)=>{let i=e.querySelector(".save-trip"),s=e.querySelector(".remove-trip"),o=e.querySelector(".done-trip");"result"===n?(w.style.display="none",o.addEventListener("click",()=>{M(a)}),s.addEventListener("click",()=>{w.style.display="block",p.innerHTML="",x=a,O()}),i.addEventListener("click",()=>{$.unshift(t),r(E+"/setnew",t),localStorage.setItem("trips",JSON.stringify($)),p.innerHTML="",i.style.display="none",g.prepend(e),O()})):(w.style.display="block",i.style.display="none",o.addEventListener("click",()=>{M(a)}),s.addEventListener("click",()=>{x=a,O()}))},M=e=>{$.find(t=>{t.id===e&&(t.done=!t.done)});let t=document.getElementById(e),n=t.classList.contains("done"),a=t.querySelector(".done-trip");n?(t.classList.remove("done"),a.innerText="Done"):(t.classList.add("done"),a.innerText="Activate"),r(E+"/done",{id:e}),localStorage.setItem("trips",JSON.stringify([])),localStorage.setItem("trips",JSON.stringify($))},I=()=>(y.style.display="block",y.innerText="You entered the wrong data!",l.value="",k(),!1);y.addEventListener("mouseover",()=>{y.style.display="none"}),f.addEventListener("click",()=>{(e=>{let t=document.getElementById(e);g.removeChild(t),$=$.filter(t=>t.id!==e),r(E+"/remove",{id:e}),localStorage.setItem("trips",JSON.stringify([])),localStorage.setItem("trips",JSON.stringify($)),k()})(x)});const k=()=>{v.classList.remove("active"),S=!1},O=()=>{S?k():(v.classList.add("active"),S=!0)};m.addEventListener("click",k),h.addEventListener("click",k),window.onload=()=>(async()=>{if(0===$.length&&null!==u){$=u.reverse(),$.forEach(e=>{i(p,g,e,"list")});let e=$.reverse();r(E+"/setall",{data:e})}else try{const e=await fetch(E+"/get");$=await e.json(),$.reverse().forEach(e=>{i(p,g,e,"list")}),localStorage.setItem("trips",JSON.stringify($.reverse()))}catch(e){console.log("error",e)}})();n(0);L()}]);